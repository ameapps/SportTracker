"use strict";(self.webpackChunkSportMonitoring=self.webpackChunkSportMonitoring||[]).push([[9072],{7805:(I,_,s)=>{s.r(_),s.d(_,{GalleryModule:()=>k});var d=s(8583),p=s(4655),m=s(4762),e=s(7716),a=s(6787),g=s(2113),v=s(1790);let y=(()=>{class t{constructor(o){this.databaseService=o,this.photos=[],this.asyncConstructor()}deletePhotosFromCloud(o){throw new Error("Method not implemented.")}asyncConstructor(){return(0,m.mG)(this,void 0,void 0,function*(){this.photos=yield this.getGalleryPhotos(a.d.FIREBASE)})}getGalleryPhotos(o){return(0,m.mG)(this,void 0,void 0,function*(){let n=[];switch(o){case a.d.IONIC_STORAGE:n=yield this.databaseService.getAllItems(a.d.IONIC_STORAGE,g.R.GALLERY);break;case a.d.FIREBASE:default:n=yield this.databaseService.getAllItems(a.d.FIREBASE,g.R.GALLERY)}return n})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(v.k))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var x=s(7001),l=s(2859),f=s(4885);function C(t,r){if(1&t&&(e.TgZ(0,"div",9),e._UZ(1,"mat-progress-spinner",10),e.TgZ(2,"div",11),e._UZ(3,"ion-icon",12),e.TgZ(4,"p"),e._uU(5),e.qZA(),e.qZA(),e.qZA()),2&t){const o=e.oxw();e.xp6(5),e.Oqu(o.selectedPhotos.length>0?"Eliminazione in corso...":"loading photoes")}}function P(t,r){1&t&&(e.TgZ(0,"div"),e.TgZ(1,"div",11),e._UZ(2,"ion-icon",13),e.TgZ(3,"p"),e._uU(4,"Error: impossible getting photos."),e._UZ(5,"br"),e._uU(6,"Please try again later."),e.qZA(),e.qZA(),e.qZA())}const T=function(t){return{"selected-photo":t}};function Z(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"ion-col",16),e.TgZ(1,"ion-card",17),e.NdJ("mousedown",function(){const c=e.CHM(o).index;return e.oxw(2).startLongPress(c)})("mouseup",function(){return e.CHM(o),e.oxw(2).cancelLongPress()})("mouseleave",function(){return e.CHM(o),e.oxw(2).cancelLongPress()})("click",function(){const i=e.CHM(o),c=i.index,h=i.$implicit,u=e.oxw(2);return u.isSelectionMode?u.togglePhotoSelection(c):u.previewPhoto(h)}),e._UZ(2,"img",18),e.TgZ(3,"ion-card-content"),e.TgZ(4,"span",19),e._uU(5),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const o=r.$implicit,n=r.index,i=e.oxw(2);e.xp6(1),e.MGl("id","gallery-photo-",n,""),e.Q6J("ngClass",e.VKq(5,T,i.isSelectionMode&&i.selectedPhotos.includes(n))),e.xp6(1),e.Q6J("src",o.webviewPath,e.LSH)("alt",o.filepath),e.xp6(3),e.Oqu(o.filepath)}}function M(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"div",20),e.TgZ(1,"ion-button",21),e.NdJ("click",function(){return e.CHM(o),e.oxw(2).deleteSelectedPhotos()}),e._UZ(2,"ion-icon",22),e._uU(3," Elimina "),e.qZA(),e.TgZ(4,"ion-button",23),e.NdJ("click",function(){return e.CHM(o),e.oxw(2).clearSelection()}),e._UZ(5,"ion-icon",24),e._uU(6," Annulla "),e.qZA(),e.qZA()}if(2&t){const o=e.oxw(2);e.xp6(1),e.Q6J("disabled",0===o.selectedPhotos.length)}}function w(t,r){if(1&t&&(e.TgZ(0,"div"),e.TgZ(1,"ion-grid"),e.TgZ(2,"ion-row"),e.YNc(3,Z,6,7,"ion-col",14),e.qZA(),e.qZA(),e.YNc(4,M,7,1,"div",15),e.qZA()),2&t){const o=e.oxw();e.xp6(3),e.Q6J("ngForOf",o.componentService.photos),e.xp6(1),e.Q6J("ngIf",o.isSelectionMode)}}function S(t,r){1&t&&(e.TgZ(0,"div",11),e._UZ(1,"ion-icon",12),e.TgZ(2,"p"),e._uU(3,"No photos available."),e._UZ(4,"br"),e._uU(5,"Take or upload a photo to get started!"),e.qZA(),e.qZA())}function G(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"div",25),e.NdJ("click",function(){return e.CHM(o),e.oxw().closePreview()}),e.TgZ(1,"div",26),e.NdJ("click",function(i){return i.stopPropagation()}),e._UZ(2,"img",18),e.TgZ(3,"ion-button",27),e.NdJ("click",function(){return e.CHM(o),e.oxw().closePreview()}),e._uU(4,"Close"),e.qZA(),e.qZA(),e.qZA()}if(2&t){const o=e.oxw();e.xp6(2),e.Q6J("src",o.selectedPhotoForPreview.webviewPath,e.LSH)("alt",o.selectedPhotoForPreview.filepath)}}const b=[{path:"",component:(()=>{class t{constructor(o,n,i,c){this.router=o,this.componentService=n,this.cdr=i,this.snackBar=c,this.loaderMs=5e3,this.isLoading=!0,this.isTimeout=!1,this.folder="Gallery",this.isSelectionMode=!1,this.selectedPhotos=[],this.selectedPhotoForPreview=null}ngOnInit(){this.isLoading=!0,this.isTimeout=!1,this.isSelectionMode=!1,this.selectedPhotos=[],this.timeoutRef=setTimeout(()=>{(!this.componentService.photos||0===this.componentService.photos.length)&&(this.isTimeout=!0,this.isLoading=!1,this.cdr.detectChanges())},this.loaderMs);const o=setInterval(()=>{this.componentService.photos&&this.componentService.photos.length>0&&(this.isLoading=!1,clearTimeout(this.timeoutRef),clearInterval(o),this.cdr.detectChanges())},500);console.info("gallery component initialized")}smoothScroll(o){document.getElementById(`gallery-photo-${o}`).scrollIntoView({behavior:"smooth"})}startLongPress(o){this.longPressTimeout=setTimeout(()=>{this.isSelectionMode=!0,this.togglePhotoSelection(o)},500)}cancelLongPress(){clearTimeout(this.longPressTimeout)}togglePhotoSelection(o){if(!this.isSelectionMode)return;const n=this.selectedPhotos.indexOf(o);n>-1?this.selectedPhotos.splice(n,1):this.selectedPhotos.push(o)}clearSelection(){this.isSelectionMode=!1,this.selectedPhotos=[]}deleteSelectedPhotos(){return(0,m.mG)(this,void 0,void 0,function*(){if(0===this.selectedPhotos.length)return;this.isLoading=!0,this.cdr.detectChanges();const n=this.selectedPhotos.map(c=>this.componentService.photos[c]);let i=!1;setTimeout(()=>{i||(this.isLoading=!1,this.clearSelection(),this.cdr.detectChanges(),this.snackBar.open("Photo deletion failed within the given time","Close",{duration:4e3}))},this.loaderMs);try{yield this.componentService.deletePhotosFromCloud(n),this.componentService.photos=this.componentService.photos.filter((c,h)=>!this.selectedPhotos.includes(h)),i=!0,setTimeout(()=>{this.isLoading=!1,this.clearSelection(),this.cdr.detectChanges(),this.snackBar.open("Photos deleted successfully!","Close",{duration:3e3})},this.loaderMs)}catch(c){i=!0,setTimeout(()=>{this.isLoading=!1,this.clearSelection(),this.cdr.detectChanges(),this.snackBar.open("Error while deleting the photos!","Close",{duration:4e3})},this.loaderMs),console.error("Errore eliminazione foto:",c)}})}previewPhoto(o){this.selectedPhotoForPreview=o}closePreview(){this.selectedPhotoForPreview=null}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(p.F0),e.Y36(y),e.Y36(e.sBO),e.Y36(x.ux))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-gallery"]],decls:15,vars:7,consts:[[3,"translucent"],["color","primary"],["slot","start"],[3,"fullscreen"],[1,"gallery-container"],["class","gallery-loader",4,"ngIf"],[4,"ngIf"],["class","empty-gallery",4,"ngIf"],["class","photo-preview-overlay",3,"click",4,"ngIf"],[1,"gallery-loader"],["color","primary","mode","indeterminate","diameter","48"],[1,"empty-gallery"],["name","images-outline","size","large"],["name","alert-circle-outline","size","large"],["size","6","sizeMd","4","sizeLg","3",4,"ngFor","ngForOf"],["class","photo-action-menu",4,"ngIf"],["size","6","sizeMd","4","sizeLg","3"],[1,"photo-card",3,"ngClass","id","mousedown","mouseup","mouseleave","click"],[3,"src","alt"],[1,"photo-name"],[1,"photo-action-menu"],["color","danger",3,"disabled","click"],["name","trash-outline"],["color","medium",3,"click"],["name","close-outline"],[1,"photo-preview-overlay",3,"click"],[1,"photo-preview-content",3,"click"],["color","primary",3,"click"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-header",0),e.TgZ(1,"ion-toolbar",1),e.TgZ(2,"ion-buttons",2),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Gallery"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"ion-content",3),e.TgZ(7,"div",4),e.TgZ(8,"h2"),e._uU(9,"Your photos"),e.qZA(),e.YNc(10,C,6,1,"div",5),e.YNc(11,P,7,0,"div",6),e.YNc(12,w,5,2,"div",6),e.YNc(13,S,6,0,"div",7),e.qZA(),e.YNc(14,G,5,2,"div",8),e.qZA()),2&o&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(4),e.Q6J("ngIf",n.isLoading),e.xp6(1),e.Q6J("ngIf",n.isTimeout),e.xp6(1),e.Q6J("ngIf",!n.isLoading&&!n.isTimeout&&(null==n.componentService.photos?null:n.componentService.photos.length)>0),e.xp6(1),e.Q6J("ngIf",!n.isLoading&&!n.isTimeout&&0===(null==n.componentService.photos?null:n.componentService.photos.length)),e.xp6(1),e.Q6J("ngIf",n.selectedPhotoForPreview))},directives:[l.Gu,l.sr,l.Sm,l.fG,l.wd,l.W2,d.O5,f.Ou,l.gu,l.jY,l.Nd,d.sg,l.wI,l.PM,d.mk,l.FN,l.YG],styles:[".selected-photo[_ngcontent-%COMP%]{border:3px solid var(--ion-color-primary);opacity:.7}.photo-action-menu[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;width:100vw;background:var(--ion-color-primary, #3880ff)!important;color:#fff;display:flex;justify-content:center;grid-gap:2rem;gap:2rem;padding:1rem 0;z-index:3000}.gallery-loader[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.55);z-index:2000;display:flex;flex-direction:column;justify-content:center;align-items:center}.gallery-container[_ngcontent-%COMP%]{padding:2rem 1rem;text-align:center;min-height:100%;background:var(--ion-color-light)}h2[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:1.6rem;margin-bottom:1.5rem;font-weight:600}ion-grid[_ngcontent-%COMP%]{margin:0 auto}mat-progress-spinner[_ngcontent-%COMP%]{width:48px;height:48px;position:relative;top:5%}.photo-card[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s;border-radius:16px;box-shadow:0 2px 8px #2878c814;cursor:pointer;background:#fff;margin-bottom:1rem}.photo-card[_ngcontent-%COMP%]:hover{transform:scale(1.04);box-shadow:0 6px 18px #2878c826}.photo-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:160px;object-fit:cover;border-radius:16px 16px 0 0}.photo-name[_ngcontent-%COMP%]{display:block;margin-top:.5rem;font-size:.95rem;color:var(--ion-color-medium);word-break:break-all}.empty-gallery[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px;color:var(--ion-color-medium)}.empty-gallery[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:4rem;color:var(--ion-color-primary);margin-bottom:1rem}.empty-gallery[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem}.photo-preview-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);z-index:4000;display:flex;justify-content:center;align-items:center}.photo-preview-content[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;box-shadow:0 4px 24px #2878c82e;display:flex;flex-direction:column;align-items:center}.photo-preview-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:80vw;max-height:70vh;border-radius:12px;margin-bottom:1rem}"]}),t})()}];let A=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[p.Bz.forChild(b)],p.Bz]}),t})();var O=s(5731);let k=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[d.ez,f.Cq,A,l.Pc,O.q]]}),t})()}}]);